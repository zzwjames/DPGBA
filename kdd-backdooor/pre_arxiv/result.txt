Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=12, selection_method='none', target_class=6, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
unlabeled_idx 53470
Epoch [1], Loss: 0.2479
Epoch [2], Loss: 0.2457
Epoch [3], Loss: 0.2434
Epoch [4], Loss: 0.2409
Epoch [5], Loss: 0.2381
Epoch [6], Loss: 0.2350
Epoch [7], Loss: 0.2313
Epoch [8], Loss: 0.2271
Epoch [9], Loss: 0.2222
Epoch [10], Loss: 0.2165
Epoch [11], Loss: 0.2098
Epoch [12], Loss: 0.2019
Epoch [13], Loss: 0.1927
Epoch [14], Loss: 0.1820
Epoch [15], Loss: 0.1697
Epoch [16], Loss: 0.1556
Epoch [17], Loss: 0.1399
Epoch [18], Loss: 0.1226
Epoch [19], Loss: 0.1041
Epoch [20], Loss: 0.0851
Epoch [21], Loss: 0.0662
Epoch [22], Loss: 0.0487
Epoch [23], Loss: 0.0334
Epoch [24], Loss: 0.0213
Epoch [25], Loss: 0.0126
Epoch [26], Loss: 0.0069
Epoch [27], Loss: 0.0035
Epoch [28], Loss: 0.0017
Epoch [29], Loss: 0.0008
Epoch [30], Loss: 0.0004
mean tensor(0.0002, device='cuda:2')
std tensor(3.1180e-05, device='cuda:2')
12072
Epoch 0, loss_inner: 1.94492, loss_target: 3.53960, homo loss: 0.00000, loss_dis: 5.46415, loss_diff: 5.46415, loss_adv: 3.53960, loss_targetclass: 3.53960, ood_score: 0.00000 
acc_train_clean: 0.1102, ASR_train_attach: 0.0000, ASR_train_outter: 0.3764
Epoch 20, loss_inner: 1.62586, loss_target: 0.89856, homo loss: 0.00000, loss_dis: 5.45053, loss_diff: 5.45053, loss_adv: 0.89856, loss_targetclass: 0.89856, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 1.60774, loss_target: 1.34510, homo loss: 0.00000, loss_dis: 8.18007, loss_diff: 8.18007, loss_adv: 1.34510, loss_targetclass: 1.34510, ood_score: 0.00002 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 1.59931, loss_target: 1.35208, homo loss: 0.00000, loss_dis: 11.49859, loss_diff: 11.49859, loss_adv: 1.35208, loss_targetclass: 1.35208, ood_score: 0.00000 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 80, loss_inner: 1.58800, loss_target: 1.02612, homo loss: 0.00000, loss_dis: 6.63361, loss_diff: 6.63361, loss_adv: 1.02612, loss_targetclass: 1.02612, ood_score: 0.00002 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 100, loss_inner: 1.57884, loss_target: 0.99084, homo loss: 0.00000, loss_dis: 6.45217, loss_diff: 6.45217, loss_adv: 0.99084, loss_targetclass: 0.99084, ood_score: 0.00004 
acc_train_clean: 0.4249, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
Epoch 120, loss_inner: 1.56982, loss_target: 0.94448, homo loss: 0.00000, loss_dis: 4.93460, loss_diff: 4.93460, loss_adv: 0.94448, loss_targetclass: 0.94448, ood_score: 0.00002 
acc_train_clean: 0.4261, ASR_train_attach: 0.9875, ASR_train_outter: 0.9964
Epoch 140, loss_inner: 1.55772, loss_target: 0.61261, homo loss: 0.00000, loss_dis: 5.69569, loss_diff: 5.69569, loss_adv: 0.61261, loss_targetclass: 0.61261, ood_score: 0.00002 
acc_train_clean: 0.4296, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 160, loss_inner: 1.54594, loss_target: 0.65690, homo loss: 0.00000, loss_dis: 5.03414, loss_diff: 5.03414, loss_adv: 0.65690, loss_targetclass: 0.65690, ood_score: 0.00002 
acc_train_clean: 0.4403, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 180, loss_inner: 1.53643, loss_target: 0.58780, homo loss: 0.00000, loss_dis: 4.71756, loss_diff: 4.71756, loss_adv: 0.58780, loss_targetclass: 0.58780, ood_score: 0.00002 
acc_train_clean: 0.4471, ASR_train_attach: 0.9875, ASR_train_outter: 0.9957
Epoch 200, loss_inner: 1.53065, loss_target: 0.70241, homo loss: 0.00000, loss_dis: 5.63235, loss_diff: 5.63235, loss_adv: 0.70241, loss_targetclass: 0.70241, ood_score: 0.00002 
acc_train_clean: 0.4528, ASR_train_attach: 0.9875, ASR_train_outter: 0.9928
Epoch 220, loss_inner: 1.52599, loss_target: 0.43576, homo loss: 0.00000, loss_dis: 5.10135, loss_diff: 5.10135, loss_adv: 0.43576, loss_targetclass: 0.43576, ood_score: 0.00002 
acc_train_clean: 0.4594, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 240, loss_inner: 1.52341, loss_target: 0.52687, homo loss: 0.00000, loss_dis: 5.10371, loss_diff: 5.10371, loss_adv: 0.52687, loss_targetclass: 0.52687, ood_score: 0.00003 
acc_train_clean: 0.4594, ASR_train_attach: 0.9875, ASR_train_outter: 0.9935
Epoch 260, loss_inner: 1.52185, loss_target: 0.66572, homo loss: 0.00000, loss_dis: 5.08583, loss_diff: 5.08583, loss_adv: 0.66572, loss_targetclass: 0.66572, ood_score: 0.00002 
acc_train_clean: 0.4599, ASR_train_attach: 0.9875, ASR_train_outter: 0.9895
Epoch 280, loss_inner: 1.52040, loss_target: 0.67448, homo loss: 0.00000, loss_dis: 4.26531, loss_diff: 4.26531, loss_adv: 0.67448, loss_targetclass: 0.67448, ood_score: 0.00003 
acc_train_clean: 0.4624, ASR_train_attach: 0.9875, ASR_train_outter: 0.9885
Epoch 300, loss_inner: 1.51965, loss_target: 0.81036, homo loss: 0.00000, loss_dis: 5.37441, loss_diff: 5.37441, loss_adv: 0.81036, loss_targetclass: 0.81036, ood_score: 0.00002 
acc_train_clean: 0.4638, ASR_train_attach: 0.9875, ASR_train_outter: 0.9835
Epoch 320, loss_inner: 1.51774, loss_target: 0.37351, homo loss: 0.00000, loss_dis: 5.41773, loss_diff: 5.41773, loss_adv: 0.37351, loss_targetclass: 0.37351, ood_score: 0.00003 
acc_train_clean: 0.4634, ASR_train_attach: 0.9875, ASR_train_outter: 0.9971
Epoch 340, loss_inner: 1.51742, loss_target: 0.45182, homo loss: 0.00000, loss_dis: 5.33349, loss_diff: 5.33349, loss_adv: 0.45182, loss_targetclass: 0.45182, ood_score: 0.00002 
acc_train_clean: 0.4643, ASR_train_attach: 0.9875, ASR_train_outter: 0.9938
Epoch 360, loss_inner: 1.51668, loss_target: 0.37333, homo loss: 0.00000, loss_dis: 5.69465, loss_diff: 5.69465, loss_adv: 0.37333, loss_targetclass: 0.37333, ood_score: 0.00002 
acc_train_clean: 0.4658, ASR_train_attach: 0.9875, ASR_train_outter: 0.9964
Epoch 380, loss_inner: 1.51625, loss_target: 0.30847, homo loss: 0.00000, loss_dis: 5.97769, loss_diff: 5.97769, loss_adv: 0.30847, loss_targetclass: 0.30847, ood_score: 0.00002 
acc_train_clean: 0.4674, ASR_train_attach: 0.9875, ASR_train_outter: 0.9981
Epoch 400, loss_inner: 1.51585, loss_target: 0.26508, homo loss: 0.00000, loss_dis: 5.43980, loss_diff: 5.43980, loss_adv: 0.26508, loss_targetclass: 0.26508, ood_score: 0.00002 
acc_train_clean: 0.4668, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 420, loss_inner: 1.51611, loss_target: 0.48302, homo loss: 0.00000, loss_dis: 5.76466, loss_diff: 5.76466, loss_adv: 0.48302, loss_targetclass: 0.48302, ood_score: 0.00002 
acc_train_clean: 0.4659, ASR_train_attach: 0.9875, ASR_train_outter: 0.9926
Epoch 440, loss_inner: 1.51584, loss_target: 0.47554, homo loss: 0.00000, loss_dis: 4.89366, loss_diff: 4.89366, loss_adv: 0.47554, loss_targetclass: 0.47554, ood_score: 0.00002 
acc_train_clean: 0.4659, ASR_train_attach: 0.9875, ASR_train_outter: 0.9935
Epoch 460, loss_inner: 1.51608, loss_target: 0.62032, homo loss: 0.00000, loss_dis: 4.00903, loss_diff: 4.00903, loss_adv: 0.62032, loss_targetclass: 0.62032, ood_score: 0.00003 
acc_train_clean: 0.4675, ASR_train_attach: 0.9875, ASR_train_outter: 0.9892
Epoch 480, loss_inner: 1.51558, loss_target: 0.50300, homo loss: 0.00000, loss_dis: 4.76297, loss_diff: 4.76297, loss_adv: 0.50300, loss_targetclass: 0.50300, ood_score: 0.00002 
acc_train_clean: 0.4652, ASR_train_attach: 0.9875, ASR_train_outter: 0.9943
Epoch 500, loss_inner: 1.51671, loss_target: 0.99276, homo loss: 0.00000, loss_dis: 4.67671, loss_diff: 4.67671, loss_adv: 0.99276, loss_targetclass: 0.99276, ood_score: 0.00002 
acc_train_clean: 0.4656, ASR_train_attach: 0.9625, ASR_train_outter: 0.9600
Epoch 520, loss_inner: 1.51499, loss_target: 0.44411, homo loss: 0.00000, loss_dis: 4.76071, loss_diff: 4.76071, loss_adv: 0.44411, loss_targetclass: 0.44411, ood_score: 0.00002 
acc_train_clean: 0.4661, ASR_train_attach: 0.9875, ASR_train_outter: 0.9957
Epoch 540, loss_inner: 1.51711, loss_target: 1.19834, homo loss: 0.00000, loss_dis: 6.98903, loss_diff: 6.98903, loss_adv: 1.19834, loss_targetclass: 1.19834, ood_score: 0.00003 
acc_train_clean: 0.4667, ASR_train_attach: 0.9125, ASR_train_outter: 0.9334
Epoch 560, loss_inner: 1.51456, loss_target: 0.43870, homo loss: 0.00000, loss_dis: 4.70616, loss_diff: 4.70616, loss_adv: 0.43870, loss_targetclass: 0.43870, ood_score: 0.00002 
acc_train_clean: 0.4675, ASR_train_attach: 0.9875, ASR_train_outter: 0.9928
Epoch 580, loss_inner: 1.51550, loss_target: 0.55612, homo loss: 0.00000, loss_dis: 4.88271, loss_diff: 4.88271, loss_adv: 0.55612, loss_targetclass: 0.55612, ood_score: 0.00002 
acc_train_clean: 0.4663, ASR_train_attach: 0.9875, ASR_train_outter: 0.9928
Epoch 600, loss_inner: 1.51509, loss_target: 0.46339, homo loss: 0.00000, loss_dis: 5.12171, loss_diff: 5.12171, loss_adv: 0.46339, loss_targetclass: 0.46339, ood_score: 0.00002 
acc_train_clean: 0.4675, ASR_train_attach: 0.9875, ASR_train_outter: 0.9945
Epoch 620, loss_inner: 1.51505, loss_target: 0.47139, homo loss: 0.00000, loss_dis: 4.74940, loss_diff: 4.74940, loss_adv: 0.47139, loss_targetclass: 0.47139, ood_score: 0.00002 
acc_train_clean: 0.4663, ASR_train_attach: 0.9875, ASR_train_outter: 0.9947
Epoch 640, loss_inner: 1.51505, loss_target: 0.60024, homo loss: 0.00000, loss_dis: 4.30066, loss_diff: 4.30066, loss_adv: 0.60024, loss_targetclass: 0.60024, ood_score: 0.00002 
acc_train_clean: 0.4668, ASR_train_attach: 0.9875, ASR_train_outter: 0.9871
Epoch 660, loss_inner: 1.51517, loss_target: 0.56117, homo loss: 0.00000, loss_dis: 4.82935, loss_diff: 4.82935, loss_adv: 0.56117, loss_targetclass: 0.56117, ood_score: 0.00002 
acc_train_clean: 0.4678, ASR_train_attach: 0.9875, ASR_train_outter: 0.9880
Epoch 680, loss_inner: 1.51494, loss_target: 0.51751, homo loss: 0.00000, loss_dis: 4.96405, loss_diff: 4.96405, loss_adv: 0.51751, loss_targetclass: 0.51751, ood_score: 0.00002 
acc_train_clean: 0.4675, ASR_train_attach: 0.9875, ASR_train_outter: 0.9916
Epoch 700, loss_inner: 1.51487, loss_target: 0.44557, homo loss: 0.00000, loss_dis: 4.60576, loss_diff: 4.60576, loss_adv: 0.44557, loss_targetclass: 0.44557, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9940
Epoch 720, loss_inner: 1.51497, loss_target: 0.60245, homo loss: 0.00000, loss_dis: 4.78327, loss_diff: 4.78327, loss_adv: 0.60245, loss_targetclass: 0.60245, ood_score: 0.00002 
acc_train_clean: 0.4691, ASR_train_attach: 0.9875, ASR_train_outter: 0.9873
Epoch 740, loss_inner: 1.51476, loss_target: 0.39376, homo loss: 0.00000, loss_dis: 4.99154, loss_diff: 4.99154, loss_adv: 0.39376, loss_targetclass: 0.39376, ood_score: 0.00002 
acc_train_clean: 0.4677, ASR_train_attach: 0.9875, ASR_train_outter: 0.9943
Epoch 760, loss_inner: 1.51539, loss_target: 0.71763, homo loss: 0.00000, loss_dis: 3.98752, loss_diff: 3.98752, loss_adv: 0.71763, loss_targetclass: 0.71763, ood_score: 0.00003 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9813
Epoch 780, loss_inner: 1.51449, loss_target: 0.45996, homo loss: 0.00000, loss_dis: 4.41379, loss_diff: 4.41379, loss_adv: 0.45996, loss_targetclass: 0.45996, ood_score: 0.00002 
acc_train_clean: 0.4678, ASR_train_attach: 0.9875, ASR_train_outter: 0.9950
Epoch 800, loss_inner: 1.51475, loss_target: 0.40737, homo loss: 0.00000, loss_dis: 5.61377, loss_diff: 5.61377, loss_adv: 0.40737, loss_targetclass: 0.40737, ood_score: 0.00002 
acc_train_clean: 0.4671, ASR_train_attach: 0.9875, ASR_train_outter: 0.9959
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=843, selection_method='none', target_class=6, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.4560
Overall ASR: 0.9507
Flip ASR: 0.9266/4971 nodes
Overall ASR: 0.9507 (GCN model, Seed: 843)
Overall Clean Accuracy: 0.4560
Total Overall ASR: 0.9507 
Total Clean Accuracy: 0.4560
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=12, selection_method='none', target_class=6, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
unlabeled_idx 53470
Epoch [1], Loss: 0.2479
Epoch [2], Loss: 0.2457
Epoch [3], Loss: 0.2434
Epoch [4], Loss: 0.2409
Epoch [5], Loss: 0.2381
Epoch [6], Loss: 0.2350
Epoch [7], Loss: 0.2313
Epoch [8], Loss: 0.2271
Epoch [9], Loss: 0.2222
Epoch [10], Loss: 0.2165
Epoch [11], Loss: 0.2098
Epoch [12], Loss: 0.2019
Epoch [13], Loss: 0.1927
Epoch [14], Loss: 0.1820
Epoch [15], Loss: 0.1697
Epoch [16], Loss: 0.1556
Epoch [17], Loss: 0.1399
Epoch [18], Loss: 0.1226
Epoch [19], Loss: 0.1041
Epoch [20], Loss: 0.0851
Epoch [21], Loss: 0.0662
Epoch [22], Loss: 0.0487
Epoch [23], Loss: 0.0334
Epoch [24], Loss: 0.0213
Epoch [25], Loss: 0.0126
Epoch [26], Loss: 0.0069
Epoch [27], Loss: 0.0035
Epoch [28], Loss: 0.0017
Epoch [29], Loss: 0.0008
Epoch [30], Loss: 0.0004
mean tensor(0.0002, device='cuda:2')
std tensor(3.1180e-05, device='cuda:2')
12072
Epoch 0, loss_inner: 1.94492, loss_target: 3.53972, homo loss: 0.00000, loss_dis: 5.46443, loss_diff: 5.46443, loss_adv: 3.53972, loss_targetclass: 3.53972, ood_score: 0.00000 
acc_train_clean: 0.1102, ASR_train_attach: 0.0000, ASR_train_outter: 0.3745
Epoch 20, loss_inner: 1.62613, loss_target: 1.01244, homo loss: 0.00000, loss_dis: 4.94235, loss_diff: 4.94235, loss_adv: 1.01244, loss_targetclass: 1.01244, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 1.60821, loss_target: 1.50939, homo loss: 0.00000, loss_dis: 5.08657, loss_diff: 5.08657, loss_adv: 1.50939, loss_targetclass: 1.50939, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 1.59944, loss_target: 1.36455, homo loss: 0.00000, loss_dis: 5.36327, loss_diff: 5.36327, loss_adv: 1.36455, loss_targetclass: 1.36455, ood_score: 0.00007 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 80, loss_inner: 1.58844, loss_target: 1.17182, homo loss: 0.00000, loss_dis: 6.01692, loss_diff: 6.01692, loss_adv: 1.17182, loss_targetclass: 1.17182, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 0.9995
Epoch 100, loss_inner: 1.57876, loss_target: 0.93238, homo loss: 0.00000, loss_dis: 5.51020, loss_diff: 5.51020, loss_adv: 0.93238, loss_targetclass: 0.93238, ood_score: 0.00003 
acc_train_clean: 0.4249, ASR_train_attach: 0.9875, ASR_train_outter: 0.9976
Epoch 120, loss_inner: 1.56909, loss_target: 0.75486, homo loss: 0.00000, loss_dis: 5.47005, loss_diff: 5.47005, loss_adv: 0.75486, loss_targetclass: 0.75486, ood_score: 0.00003 
acc_train_clean: 0.4258, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 140, loss_inner: 1.55793, loss_target: 0.58019, homo loss: 0.00000, loss_dis: 5.89928, loss_diff: 5.89928, loss_adv: 0.58019, loss_targetclass: 0.58019, ood_score: 0.00002 
acc_train_clean: 0.4289, ASR_train_attach: 0.9875, ASR_train_outter: 0.9978
Epoch 160, loss_inner: 1.54652, loss_target: 0.63375, homo loss: 0.00000, loss_dis: 5.40272, loss_diff: 5.40272, loss_adv: 0.63375, loss_targetclass: 0.63375, ood_score: 0.00002 
acc_train_clean: 0.4392, ASR_train_attach: 0.9875, ASR_train_outter: 0.9952
Epoch 180, loss_inner: 1.53801, loss_target: 1.01045, homo loss: 0.00000, loss_dis: 6.12236, loss_diff: 6.12236, loss_adv: 1.01045, loss_targetclass: 1.01045, ood_score: 0.00002 
acc_train_clean: 0.4480, ASR_train_attach: 0.9875, ASR_train_outter: 0.9825
Epoch 200, loss_inner: 1.53143, loss_target: 0.92652, homo loss: 0.00000, loss_dis: 5.04252, loss_diff: 5.04252, loss_adv: 0.92652, loss_targetclass: 0.92652, ood_score: 0.00002 
acc_train_clean: 0.4531, ASR_train_attach: 0.9875, ASR_train_outter: 0.9852
Epoch 220, loss_inner: 1.52657, loss_target: 0.77088, homo loss: 0.00000, loss_dis: 6.06733, loss_diff: 6.06733, loss_adv: 0.77088, loss_targetclass: 0.77088, ood_score: 0.00002 
acc_train_clean: 0.4573, ASR_train_attach: 0.9875, ASR_train_outter: 0.9844
Epoch 240, loss_inner: 1.52341, loss_target: 0.59760, homo loss: 0.00000, loss_dis: 5.19360, loss_diff: 5.19360, loss_adv: 0.59760, loss_targetclass: 0.59760, ood_score: 0.00002 
acc_train_clean: 0.4628, ASR_train_attach: 0.9875, ASR_train_outter: 0.9950
Epoch 260, loss_inner: 1.52197, loss_target: 0.84165, homo loss: 0.00000, loss_dis: 4.12606, loss_diff: 4.12606, loss_adv: 0.84165, loss_targetclass: 0.84165, ood_score: 0.00003 
acc_train_clean: 0.4630, ASR_train_attach: 0.9875, ASR_train_outter: 0.9808
Epoch 280, loss_inner: 1.52102, loss_target: 0.95142, homo loss: 0.00000, loss_dis: 4.57849, loss_diff: 4.57849, loss_adv: 0.95142, loss_targetclass: 0.95142, ood_score: 0.00002 
acc_train_clean: 0.4648, ASR_train_attach: 0.9750, ASR_train_outter: 0.9773
Epoch 300, loss_inner: 1.52043, loss_target: 1.17286, homo loss: 0.00000, loss_dis: 4.73657, loss_diff: 4.73657, loss_adv: 1.17286, loss_targetclass: 1.17286, ood_score: 0.00003 
acc_train_clean: 0.4635, ASR_train_attach: 0.9500, ASR_train_outter: 0.9387
Epoch 320, loss_inner: 1.51893, loss_target: 0.90765, homo loss: 0.00000, loss_dis: 4.63893, loss_diff: 4.63893, loss_adv: 0.90765, loss_targetclass: 0.90765, ood_score: 0.00003 
acc_train_clean: 0.4675, ASR_train_attach: 0.9875, ASR_train_outter: 0.9775
Epoch 340, loss_inner: 1.51826, loss_target: 0.82477, homo loss: 0.00000, loss_dis: 4.58459, loss_diff: 4.58459, loss_adv: 0.82477, loss_targetclass: 0.82477, ood_score: 0.00003 
acc_train_clean: 0.4666, ASR_train_attach: 0.9875, ASR_train_outter: 0.9818
Epoch 360, loss_inner: 1.51782, loss_target: 0.91964, homo loss: 0.00000, loss_dis: 4.95128, loss_diff: 4.95128, loss_adv: 0.91964, loss_targetclass: 0.91964, ood_score: 0.00002 
acc_train_clean: 0.4655, ASR_train_attach: 0.9875, ASR_train_outter: 0.9753
Epoch 380, loss_inner: 1.51713, loss_target: 0.77375, homo loss: 0.00000, loss_dis: 4.51746, loss_diff: 4.51746, loss_adv: 0.77375, loss_targetclass: 0.77375, ood_score: 0.00003 
acc_train_clean: 0.4664, ASR_train_attach: 0.9875, ASR_train_outter: 0.9856
Epoch 400, loss_inner: 1.51653, loss_target: 0.62811, homo loss: 0.00000, loss_dis: 4.45832, loss_diff: 4.45832, loss_adv: 0.62811, loss_targetclass: 0.62811, ood_score: 0.00003 
acc_train_clean: 0.4664, ASR_train_attach: 0.9875, ASR_train_outter: 0.9928
Epoch 420, loss_inner: 1.51624, loss_target: 0.57620, homo loss: 0.00000, loss_dis: 5.13318, loss_diff: 5.13318, loss_adv: 0.57620, loss_targetclass: 0.57620, ood_score: 0.00002 
acc_train_clean: 0.4650, ASR_train_attach: 0.9875, ASR_train_outter: 0.9907
Epoch 440, loss_inner: 1.51635, loss_target: 0.66734, homo loss: 0.00000, loss_dis: 4.34722, loss_diff: 4.34722, loss_adv: 0.66734, loss_targetclass: 0.66734, ood_score: 0.00002 
acc_train_clean: 0.4676, ASR_train_attach: 0.9875, ASR_train_outter: 0.9923
Epoch 460, loss_inner: 1.51605, loss_target: 0.62794, homo loss: 0.00000, loss_dis: 4.68308, loss_diff: 4.68308, loss_adv: 0.62794, loss_targetclass: 0.62794, ood_score: 0.00003 
acc_train_clean: 0.4655, ASR_train_attach: 0.9875, ASR_train_outter: 0.9902
Epoch 480, loss_inner: 1.51586, loss_target: 0.58671, homo loss: 0.00000, loss_dis: 4.61764, loss_diff: 4.61764, loss_adv: 0.58671, loss_targetclass: 0.58671, ood_score: 0.00002 
acc_train_clean: 0.4670, ASR_train_attach: 0.9875, ASR_train_outter: 0.9904
Epoch 500, loss_inner: 1.51635, loss_target: 0.82687, homo loss: 0.00000, loss_dis: 4.71263, loss_diff: 4.71263, loss_adv: 0.82687, loss_targetclass: 0.82687, ood_score: 0.00003 
acc_train_clean: 0.4657, ASR_train_attach: 0.9875, ASR_train_outter: 0.9763
Epoch 520, loss_inner: 1.51598, loss_target: 0.75700, homo loss: 0.00000, loss_dis: 4.60350, loss_diff: 4.60350, loss_adv: 0.75700, loss_targetclass: 0.75700, ood_score: 0.00002 
acc_train_clean: 0.4663, ASR_train_attach: 0.9875, ASR_train_outter: 0.9804
Epoch 540, loss_inner: 1.51582, loss_target: 0.80118, homo loss: 0.00000, loss_dis: 4.52422, loss_diff: 4.52422, loss_adv: 0.80118, loss_targetclass: 0.80118, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9749
Epoch 560, loss_inner: 1.51570, loss_target: 0.68595, homo loss: 0.00000, loss_dis: 4.03840, loss_diff: 4.03840, loss_adv: 0.68595, loss_targetclass: 0.68595, ood_score: 0.00002 
acc_train_clean: 0.4673, ASR_train_attach: 0.9875, ASR_train_outter: 0.9880
Epoch 580, loss_inner: 1.51604, loss_target: 0.79206, homo loss: 0.00000, loss_dis: 4.41059, loss_diff: 4.41059, loss_adv: 0.79206, loss_targetclass: 0.79206, ood_score: 0.00002 
acc_train_clean: 0.4687, ASR_train_attach: 0.9875, ASR_train_outter: 0.9777
Epoch 600, loss_inner: 1.51553, loss_target: 0.64251, homo loss: 0.00000, loss_dis: 4.85843, loss_diff: 4.85843, loss_adv: 0.64251, loss_targetclass: 0.64251, ood_score: 0.00003 
acc_train_clean: 0.4665, ASR_train_attach: 0.9875, ASR_train_outter: 0.9880
Epoch 620, loss_inner: 1.51558, loss_target: 0.66536, homo loss: 0.00000, loss_dis: 5.28068, loss_diff: 5.28068, loss_adv: 0.66536, loss_targetclass: 0.66536, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9873
Epoch 640, loss_inner: 1.51536, loss_target: 0.59413, homo loss: 0.00000, loss_dis: 5.22566, loss_diff: 5.22566, loss_adv: 0.59413, loss_targetclass: 0.59413, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9873
Epoch 660, loss_inner: 1.51525, loss_target: 0.51540, homo loss: 0.00000, loss_dis: 4.95522, loss_diff: 4.95522, loss_adv: 0.51540, loss_targetclass: 0.51540, ood_score: 0.00002 
acc_train_clean: 0.4669, ASR_train_attach: 0.9875, ASR_train_outter: 0.9938
Epoch 680, loss_inner: 1.51519, loss_target: 0.46908, homo loss: 0.00000, loss_dis: 5.08768, loss_diff: 5.08768, loss_adv: 0.46908, loss_targetclass: 0.46908, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9969
Epoch 700, loss_inner: 1.51603, loss_target: 0.82142, homo loss: 0.00000, loss_dis: 4.79792, loss_diff: 4.79792, loss_adv: 0.82142, loss_targetclass: 0.82142, ood_score: 0.00002 
acc_train_clean: 0.4682, ASR_train_attach: 0.9875, ASR_train_outter: 0.9784
Epoch 720, loss_inner: 1.51523, loss_target: 0.56036, homo loss: 0.00000, loss_dis: 5.56067, loss_diff: 5.56067, loss_adv: 0.56036, loss_targetclass: 0.56036, ood_score: 0.00002 
acc_train_clean: 0.4673, ASR_train_attach: 0.9875, ASR_train_outter: 0.9907
Epoch 740, loss_inner: 1.51517, loss_target: 0.48878, homo loss: 0.00000, loss_dis: 5.67067, loss_diff: 5.67067, loss_adv: 0.48878, loss_targetclass: 0.48878, ood_score: 0.00002 
acc_train_clean: 0.4661, ASR_train_attach: 0.9875, ASR_train_outter: 0.9931
Epoch 760, loss_inner: 1.51514, loss_target: 0.43595, homo loss: 0.00000, loss_dis: 4.81160, loss_diff: 4.81160, loss_adv: 0.43595, loss_targetclass: 0.43595, ood_score: 0.00003 
acc_train_clean: 0.4679, ASR_train_attach: 0.9875, ASR_train_outter: 0.9962
Epoch 780, loss_inner: 1.51510, loss_target: 0.40395, homo loss: 0.00000, loss_dis: 5.80668, loss_diff: 5.80668, loss_adv: 0.40395, loss_targetclass: 0.40395, ood_score: 0.00002 
acc_train_clean: 0.4663, ASR_train_attach: 0.9875, ASR_train_outter: 0.9940
Epoch 800, loss_inner: 1.51498, loss_target: 0.37440, homo loss: 0.00000, loss_dis: 6.34869, loss_diff: 6.34869, loss_adv: 0.37440, loss_targetclass: 0.37440, ood_score: 0.00002 
acc_train_clean: 0.4664, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=843, selection_method='none', target_class=6, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.4554
Overall ASR: 0.9918
Flip ASR: 0.9863/4971 nodes
Overall ASR: 0.9918 (GCN model, Seed: 843)
Overall Clean Accuracy: 0.4554
Total Overall ASR: 0.9918 
Total Clean Accuracy: 0.4554
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=12, selection_method='none', target_class=6, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
unlabeled_idx 53470
Epoch [1], Loss: 0.2479
Epoch [2], Loss: 0.2457
Epoch [3], Loss: 0.2434
Epoch [4], Loss: 0.2409
Epoch [5], Loss: 0.2381
Epoch [6], Loss: 0.2350
Epoch [7], Loss: 0.2313
Epoch [8], Loss: 0.2271
Epoch [9], Loss: 0.2222
Epoch [10], Loss: 0.2165
Epoch [11], Loss: 0.2098
Epoch [12], Loss: 0.2019
Epoch [13], Loss: 0.1927
Epoch [14], Loss: 0.1820
Epoch [15], Loss: 0.1697
Epoch [16], Loss: 0.1556
Epoch [17], Loss: 0.1399
Epoch [18], Loss: 0.1226
Epoch [19], Loss: 0.1041
Epoch [20], Loss: 0.0851
Epoch [21], Loss: 0.0662
Epoch [22], Loss: 0.0487
Epoch [23], Loss: 0.0334
Epoch [24], Loss: 0.0213
Epoch [25], Loss: 0.0126
Epoch [26], Loss: 0.0069
Epoch [27], Loss: 0.0035
Epoch [28], Loss: 0.0017
Epoch [29], Loss: 0.0008
Epoch [30], Loss: 0.0004
mean tensor(0.0002, device='cuda:2')
std tensor(3.1180e-05, device='cuda:2')
12072
Epoch 0, loss_inner: 1.94492, loss_target: 3.53967, homo loss: 0.00000, loss_dis: 5.46457, loss_diff: 5.46457, loss_adv: 3.53967, loss_targetclass: 3.53967, ood_score: 0.00000 
acc_train_clean: 0.1102, ASR_train_attach: 0.0000, ASR_train_outter: 0.3795
Epoch 20, loss_inner: 1.62577, loss_target: 0.85749, homo loss: 0.00000, loss_dis: 6.65019, loss_diff: 6.65019, loss_adv: 0.85749, loss_targetclass: 0.85749, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 1.60696, loss_target: 1.05632, homo loss: 0.00000, loss_dis: 7.32435, loss_diff: 7.32435, loss_adv: 1.05632, loss_targetclass: 1.05632, ood_score: 0.00004 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 1.59852, loss_target: 1.13928, homo loss: 0.00000, loss_dis: 5.89485, loss_diff: 5.89485, loss_adv: 1.13928, loss_targetclass: 1.13928, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 80, loss_inner: 1.58800, loss_target: 1.16895, homo loss: 0.00000, loss_dis: 6.53567, loss_diff: 6.53567, loss_adv: 1.16895, loss_targetclass: 1.16895, ood_score: 0.00004 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 100, loss_inner: 1.57956, loss_target: 1.23508, homo loss: 0.00000, loss_dis: 4.52631, loss_diff: 4.52631, loss_adv: 1.23508, loss_targetclass: 1.23508, ood_score: 0.00003 
acc_train_clean: 0.4248, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
Epoch 120, loss_inner: 1.57010, loss_target: 1.05074, homo loss: 0.00000, loss_dis: 5.66237, loss_diff: 5.66237, loss_adv: 1.05074, loss_targetclass: 1.05074, ood_score: 0.00003 
acc_train_clean: 0.4259, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
Epoch 140, loss_inner: 1.55840, loss_target: 0.79761, homo loss: 0.00000, loss_dis: 5.36658, loss_diff: 5.36658, loss_adv: 0.79761, loss_targetclass: 0.79761, ood_score: 0.00003 
acc_train_clean: 0.4300, ASR_train_attach: 0.9875, ASR_train_outter: 0.9962
Epoch 160, loss_inner: 1.54567, loss_target: 0.51452, homo loss: 0.00000, loss_dis: 5.86625, loss_diff: 5.86625, loss_adv: 0.51452, loss_targetclass: 0.51452, ood_score: 0.00002 
acc_train_clean: 0.4410, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 180, loss_inner: 1.53621, loss_target: 0.53350, homo loss: 0.00000, loss_dis: 4.95063, loss_diff: 4.95063, loss_adv: 0.53350, loss_targetclass: 0.53350, ood_score: 0.00002 
acc_train_clean: 0.4489, ASR_train_attach: 0.9875, ASR_train_outter: 0.9974
Epoch 200, loss_inner: 1.53139, loss_target: 0.92619, homo loss: 0.00000, loss_dis: 4.87217, loss_diff: 4.87217, loss_adv: 0.92619, loss_targetclass: 0.92619, ood_score: 0.00002 
acc_train_clean: 0.4551, ASR_train_attach: 0.9875, ASR_train_outter: 0.9885
Epoch 220, loss_inner: 1.52645, loss_target: 0.63018, homo loss: 0.00000, loss_dis: 4.36011, loss_diff: 4.36011, loss_adv: 0.63018, loss_targetclass: 0.63018, ood_score: 0.00003 
acc_train_clean: 0.4587, ASR_train_attach: 0.9875, ASR_train_outter: 0.9943
Epoch 240, loss_inner: 1.52309, loss_target: 0.45602, homo loss: 0.00000, loss_dis: 5.11880, loss_diff: 5.11880, loss_adv: 0.45602, loss_targetclass: 0.45602, ood_score: 0.00002 
acc_train_clean: 0.4590, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
Epoch 260, loss_inner: 1.52171, loss_target: 0.62859, homo loss: 0.00000, loss_dis: 4.31443, loss_diff: 4.31443, loss_adv: 0.62859, loss_targetclass: 0.62859, ood_score: 0.00003 
acc_train_clean: 0.4617, ASR_train_attach: 0.9875, ASR_train_outter: 0.9943
Epoch 280, loss_inner: 1.52044, loss_target: 0.71393, homo loss: 0.00000, loss_dis: 5.27239, loss_diff: 5.27239, loss_adv: 0.71393, loss_targetclass: 0.71393, ood_score: 0.00002 
acc_train_clean: 0.4629, ASR_train_attach: 0.9875, ASR_train_outter: 0.9871
Epoch 300, loss_inner: 1.51876, loss_target: 0.48365, homo loss: 0.00000, loss_dis: 4.34105, loss_diff: 4.34105, loss_adv: 0.48365, loss_targetclass: 0.48365, ood_score: 0.00003 
acc_train_clean: 0.4638, ASR_train_attach: 0.9875, ASR_train_outter: 0.9950
Epoch 320, loss_inner: 1.51889, loss_target: 0.77895, homo loss: 0.00000, loss_dis: 7.27462, loss_diff: 7.27462, loss_adv: 0.77895, loss_targetclass: 0.77895, ood_score: 0.00003 
acc_train_clean: 0.4666, ASR_train_attach: 0.9875, ASR_train_outter: 0.9823
Epoch 340, loss_inner: 1.51761, loss_target: 0.64397, homo loss: 0.00000, loss_dis: 4.58357, loss_diff: 4.58357, loss_adv: 0.64397, loss_targetclass: 0.64397, ood_score: 0.00002 
acc_train_clean: 0.4645, ASR_train_attach: 0.9875, ASR_train_outter: 0.9885
Epoch 360, loss_inner: 1.51817, loss_target: 1.01974, homo loss: 0.00000, loss_dis: 4.82097, loss_diff: 4.82097, loss_adv: 1.01974, loss_targetclass: 1.01974, ood_score: 0.00002 
acc_train_clean: 0.4649, ASR_train_attach: 0.9625, ASR_train_outter: 0.9588
Epoch 380, loss_inner: 1.51628, loss_target: 0.48345, homo loss: 0.00000, loss_dis: 4.66244, loss_diff: 4.66244, loss_adv: 0.48345, loss_targetclass: 0.48345, ood_score: 0.00002 
acc_train_clean: 0.4678, ASR_train_attach: 0.9875, ASR_train_outter: 0.9933
Epoch 400, loss_inner: 1.51642, loss_target: 0.65616, homo loss: 0.00000, loss_dis: 5.08448, loss_diff: 5.08448, loss_adv: 0.65616, loss_targetclass: 0.65616, ood_score: 0.00002 
acc_train_clean: 0.4669, ASR_train_attach: 0.9875, ASR_train_outter: 0.9878
Epoch 420, loss_inner: 1.51586, loss_target: 0.49286, homo loss: 0.00000, loss_dis: 4.59812, loss_diff: 4.59812, loss_adv: 0.49286, loss_targetclass: 0.49286, ood_score: 0.00002 
acc_train_clean: 0.4656, ASR_train_attach: 0.9875, ASR_train_outter: 0.9952
Epoch 440, loss_inner: 1.51662, loss_target: 0.83763, homo loss: 0.00000, loss_dis: 4.81748, loss_diff: 4.81748, loss_adv: 0.83763, loss_targetclass: 0.83763, ood_score: 0.00002 
acc_train_clean: 0.4667, ASR_train_attach: 0.9875, ASR_train_outter: 0.9758
Epoch 460, loss_inner: 1.51550, loss_target: 0.48691, homo loss: 0.00000, loss_dis: 4.81407, loss_diff: 4.81407, loss_adv: 0.48691, loss_targetclass: 0.48691, ood_score: 0.00002 
acc_train_clean: 0.4677, ASR_train_attach: 0.9875, ASR_train_outter: 0.9933
Epoch 480, loss_inner: 1.51615, loss_target: 0.76620, homo loss: 0.00000, loss_dis: 4.99492, loss_diff: 4.99492, loss_adv: 0.76620, loss_targetclass: 0.76620, ood_score: 0.00002 
acc_train_clean: 0.4664, ASR_train_attach: 0.9875, ASR_train_outter: 0.9794
Epoch 500, loss_inner: 1.51524, loss_target: 0.51850, homo loss: 0.00000, loss_dis: 4.99260, loss_diff: 4.99260, loss_adv: 0.51850, loss_targetclass: 0.51850, ood_score: 0.00002 
acc_train_clean: 0.4672, ASR_train_attach: 0.9875, ASR_train_outter: 0.9911
Epoch 520, loss_inner: 1.51553, loss_target: 0.60422, homo loss: 0.00000, loss_dis: 4.11794, loss_diff: 4.11794, loss_adv: 0.60422, loss_targetclass: 0.60422, ood_score: 0.00002 
acc_train_clean: 0.4652, ASR_train_attach: 0.9875, ASR_train_outter: 0.9895
Epoch 540, loss_inner: 1.51521, loss_target: 0.52823, homo loss: 0.00000, loss_dis: 4.65641, loss_diff: 4.65641, loss_adv: 0.52823, loss_targetclass: 0.52823, ood_score: 0.00002 
acc_train_clean: 0.4676, ASR_train_attach: 0.9875, ASR_train_outter: 0.9940
Epoch 560, loss_inner: 1.51497, loss_target: 0.41424, homo loss: 0.00000, loss_dis: 4.27645, loss_diff: 4.27645, loss_adv: 0.41424, loss_targetclass: 0.41424, ood_score: 0.00002 
acc_train_clean: 0.4662, ASR_train_attach: 0.9875, ASR_train_outter: 0.9962
Epoch 580, loss_inner: 1.51600, loss_target: 0.83797, homo loss: 0.00000, loss_dis: 4.48600, loss_diff: 4.48600, loss_adv: 0.83797, loss_targetclass: 0.83797, ood_score: 0.00002 
acc_train_clean: 0.4677, ASR_train_attach: 0.9875, ASR_train_outter: 0.9768
Epoch 600, loss_inner: 1.51465, loss_target: 0.46885, homo loss: 0.00000, loss_dis: 4.63351, loss_diff: 4.63351, loss_adv: 0.46885, loss_targetclass: 0.46885, ood_score: 0.00002 
acc_train_clean: 0.4677, ASR_train_attach: 0.9875, ASR_train_outter: 0.9904
Epoch 620, loss_inner: 1.51591, loss_target: 0.79766, homo loss: 0.00000, loss_dis: 4.27364, loss_diff: 4.27364, loss_adv: 0.79766, loss_targetclass: 0.79766, ood_score: 0.00002 
acc_train_clean: 0.4666, ASR_train_attach: 0.9875, ASR_train_outter: 0.9796
Epoch 640, loss_inner: 1.51474, loss_target: 0.51932, homo loss: 0.00000, loss_dis: 3.83626, loss_diff: 3.83626, loss_adv: 0.51932, loss_targetclass: 0.51932, ood_score: 0.00003 
acc_train_clean: 0.4666, ASR_train_attach: 0.9875, ASR_train_outter: 0.9935
Epoch 660, loss_inner: 1.51503, loss_target: 0.50933, homo loss: 0.00000, loss_dis: 4.33273, loss_diff: 4.33273, loss_adv: 0.50933, loss_targetclass: 0.50933, ood_score: 0.00002 
acc_train_clean: 0.4676, ASR_train_attach: 0.9875, ASR_train_outter: 0.9914
Epoch 680, loss_inner: 1.51499, loss_target: 0.48837, homo loss: 0.00000, loss_dis: 3.87894, loss_diff: 3.87894, loss_adv: 0.48837, loss_targetclass: 0.48837, ood_score: 0.00002 
acc_train_clean: 0.4681, ASR_train_attach: 0.9875, ASR_train_outter: 0.9940
Epoch 700, loss_inner: 1.51479, loss_target: 0.53334, homo loss: 0.00000, loss_dis: 4.65961, loss_diff: 4.65961, loss_adv: 0.53334, loss_targetclass: 0.53334, ood_score: 0.00002 
acc_train_clean: 0.4665, ASR_train_attach: 0.9875, ASR_train_outter: 0.9899
Epoch 720, loss_inner: 1.51482, loss_target: 0.45783, homo loss: 0.00000, loss_dis: 4.02619, loss_diff: 4.02619, loss_adv: 0.45783, loss_targetclass: 0.45783, ood_score: 0.00003 
acc_train_clean: 0.4670, ASR_train_attach: 0.9875, ASR_train_outter: 0.9940
Epoch 740, loss_inner: 1.51484, loss_target: 0.46240, homo loss: 0.00000, loss_dis: 4.02684, loss_diff: 4.02684, loss_adv: 0.46240, loss_targetclass: 0.46240, ood_score: 0.00002 
acc_train_clean: 0.4673, ASR_train_attach: 0.9875, ASR_train_outter: 0.9926
Epoch 760, loss_inner: 1.51480, loss_target: 0.54024, homo loss: 0.00000, loss_dis: 4.01538, loss_diff: 4.01538, loss_adv: 0.54024, loss_targetclass: 0.54024, ood_score: 0.00002 
acc_train_clean: 0.4678, ASR_train_attach: 0.9875, ASR_train_outter: 0.9928
Epoch 780, loss_inner: 1.51521, loss_target: 0.62076, homo loss: 0.00000, loss_dis: 4.01469, loss_diff: 4.01469, loss_adv: 0.62076, loss_targetclass: 0.62076, ood_score: 0.00002 
acc_train_clean: 0.4650, ASR_train_attach: 0.9875, ASR_train_outter: 0.9883
Epoch 800, loss_inner: 1.51556, loss_target: 0.86739, homo loss: 0.00000, loss_dis: 4.88957, loss_diff: 4.88957, loss_adv: 0.86739, loss_targetclass: 0.86739, ood_score: 0.00002 
acc_train_clean: 0.4659, ASR_train_attach: 0.9875, ASR_train_outter: 0.9715
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=843, selection_method='none', target_class=6, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
target class rate on Vs: 0.9625
accuracy on clean test nodes: 0.4539
Overall ASR: 0.8643
Flip ASR: 0.8101/4971 nodes
Overall ASR: 0.8643 (GCN model, Seed: 843)
Overall Clean Accuracy: 0.4539
Total Overall ASR: 0.8643 
Total Clean Accuracy: 0.4539
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='reconstruct', device_id=2, dis_weight=1, dropout=0.5, epochs=801, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=160.0, inner=1, k=100, lr=0.01, model='GCN', no_cuda=False, outter_size=4096, prune_thr=0.4, range=0.1, rec_epochs=30, seed=12, selection_method='none', target_class=6, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=801, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005, weight_ood=1.0, weight_target=1, weight_targetclass=1)
unlabeled_idx 53470
Epoch [1], Loss: 0.2479
Epoch [2], Loss: 0.2457
Epoch [3], Loss: 0.2434
Epoch [4], Loss: 0.2409
Epoch [5], Loss: 0.2381
Epoch [6], Loss: 0.2350
Epoch [7], Loss: 0.2313
Epoch [8], Loss: 0.2271
Epoch [9], Loss: 0.2222
Epoch [10], Loss: 0.2165
Epoch [11], Loss: 0.2098
Epoch [12], Loss: 0.2019
Epoch [13], Loss: 0.1927
Epoch [14], Loss: 0.1820
Epoch [15], Loss: 0.1697
Epoch [16], Loss: 0.1556
Epoch [17], Loss: 0.1399
Epoch [18], Loss: 0.1226
Epoch [19], Loss: 0.1041
Epoch [20], Loss: 0.0851
Epoch [21], Loss: 0.0662
Epoch [22], Loss: 0.0487
Epoch [23], Loss: 0.0334
Epoch [24], Loss: 0.0213
Epoch [25], Loss: 0.0126
Epoch [26], Loss: 0.0069
Epoch [27], Loss: 0.0035
Epoch [28], Loss: 0.0017
Epoch [29], Loss: 0.0008
Epoch [30], Loss: 0.0004
mean tensor(0.0002, device='cuda:2')
std tensor(3.1180e-05, device='cuda:2')
12072
Epoch 0, loss_inner: 1.94492, loss_target: 3.53970, homo loss: 0.00000, loss_dis: 5.46458, loss_diff: 5.46458, loss_adv: 3.53970, loss_targetclass: 3.53970, ood_score: 0.00000 
acc_train_clean: 0.1102, ASR_train_attach: 0.0000, ASR_train_outter: 0.3831
Epoch 20, loss_inner: 1.62668, loss_target: 1.23676, homo loss: 0.00000, loss_dis: 5.81783, loss_diff: 5.81783, loss_adv: 1.23676, loss_targetclass: 1.23676, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 1.60775, loss_target: 1.32465, homo loss: 0.00000, loss_dis: 6.72087, loss_diff: 6.72087, loss_adv: 1.32465, loss_targetclass: 1.32465, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 1.59871, loss_target: 1.14316, homo loss: 0.00000, loss_dis: 6.03260, loss_diff: 6.03260, loss_adv: 1.14316, loss_targetclass: 1.14316, ood_score: 0.00002 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 80, loss_inner: 1.58812, loss_target: 1.17500, homo loss: 0.00000, loss_dis: 5.71541, loss_diff: 5.71541, loss_adv: 1.17500, loss_targetclass: 1.17500, ood_score: 0.00003 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 0.9995
Epoch 100, loss_inner: 1.57984, loss_target: 1.29429, homo loss: 0.00000, loss_dis: 11.35831, loss_diff: 11.35831, loss_adv: 1.29429, loss_targetclass: 1.29429, ood_score: 0.00001 
acc_train_clean: 0.4248, ASR_train_attach: 0.9875, ASR_train_outter: 0.9976
